<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Maxwell Pepperdine">
<meta name="dcterms.date" content="2025-05-11">
<meta name="description" content="An open-source Python workflow for accessing, processing, and mapping large-scale historical and projected climate model data">

<title>Maxwell Pepperdine - From clouds to code: mapping big climate data with Python</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/my-favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/my-favicon.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Maxwell Pepperdine</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html"> 
<span class="menu-text">Portfolio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Resume/WebsiteResume.pdf" target="_blank"> 
<span class="menu-text">Resume</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page-left">
      <h1 class="title">From clouds to code: mapping big climate data with Python</h1>
                  <div>
        <div class="description">
          An open-source Python workflow for accessing, processing, and mapping large-scale historical and projected climate model data
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Geospatial-analysis</div>
                <div class="quarto-category">Python</div>
                <div class="quarto-category">MESM</div>
              </div>
                  </div>
  </div>
    
  <div class="quarto-title-meta-author column-page-left">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author"><a href="https://maxpepperdine.github.io">Maxwell Pepperdine</a> </p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              MESM
            </p>
        </div>
    </div>

  <div class="quarto-title-meta column-page-left">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">May 11, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#mapping-geospatial-analysis" id="toc-mapping-geospatial-analysis" class="nav-link active" data-scroll-target="#mapping-geospatial-analysis">Mapping &amp; Geospatial Analysis</a>
  <ul class="collapse">
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview"><strong>Overview</strong></a></li>
  <li><a href="#climate-data-description" id="toc-climate-data-description" class="nav-link" data-scroll-target="#climate-data-description"><strong>(1) Climate Data Description</strong></a></li>
  <li><a href="#climate-data-download-acquisition" id="toc-climate-data-download-acquisition" class="nav-link" data-scroll-target="#climate-data-download-acquisition"><strong>(2) Climate Data Download &amp; Acquisition</strong></a></li>
  <li><a href="#focus-region-southern-africa" id="toc-focus-region-southern-africa" class="nav-link" data-scroll-target="#focus-region-southern-africa"><strong>(3) Focus Region – Southern Africa</strong></a></li>
  <li><a href="#focus-on-specific-time-periods-make-maps" id="toc-focus-on-specific-time-periods-make-maps" class="nav-link" data-scroll-target="#focus-on-specific-time-periods-make-maps"><strong>(4) Focus on Specific Time Periods &amp; Make Maps</strong></a>
  <ul class="collapse">
  <li><a href="#data-processing" id="toc-data-processing" class="nav-link" data-scroll-target="#data-processing"><strong>Data Processing</strong></a></li>
  <li><a href="#map-the-mean-average-over-each-time-period" id="toc-map-the-mean-average-over-each-time-period" class="nav-link" data-scroll-target="#map-the-mean-average-over-each-time-period"><strong>Map the Mean Average Over Each Time Period</strong></a></li>
  <li><a href="#map-the-difference-in-the-averages-between-the-two-time-periods" id="toc-map-the-difference-in-the-averages-between-the-two-time-periods" class="nav-link" data-scroll-target="#map-the-difference-in-the-averages-between-the-two-time-periods"><strong>Map the Difference in the Averages Between the Two Time Periods</strong></a></li>
  </ul></li>
  <li><a href="#reflection" id="toc-reflection" class="nav-link" data-scroll-target="#reflection"><strong>(5) Reflection</strong></a></li>
  <li><a href="#acknowledgements" id="toc-acknowledgements" class="nav-link" data-scroll-target="#acknowledgements"><strong>(6) Acknowledgements</strong></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page-left" id="quarto-document-content">





<section id="mapping-geospatial-analysis" class="level1">
<h1>Mapping &amp; Geospatial Analysis</h1>
<p><em>A workflow adapted from the <a href="https://github.com/climate-datalab">Climate DataLab</a> as part of EDS 296-1S (Advanced Special Topics in Environmental Data Science: A Climate Modeling Perspective on Big Data Techniques), a course offered at the Bren School of Environmental Science &amp; Management.</em></p>
<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview"><strong>Overview</strong></h2>
<p>This post walks through the process of accessing, processing, and visualizing large-scale climate data from Amazon Web Services (AWS) using <code>Python</code> in a <code>Jupyter Lab</code> environment. Focusing on Southern Africa, the analysis draws on two global climate models — <code>GFDL-ESM4</code> and <code>IPSL-CM6A-LR</code> — to download and map historical simulations and future projections of air temperature. The workflow highlights geospatial data manipulation with <code>xarray</code>, <code>rioxarray</code>, and <code>geopandas</code>, including time averaging, model comparison, and visualization using <code>matplotlib</code> and <code>cartopy</code>. This post provides a practical introduction to open-source tools for regional climate analysis with cloud-hosted datasets.</p>
<div id="834d48a9-4f75-481d-ace9-ed2303a40029" class="cell" data-quarto="{&quot;code&quot;:true,&quot;output&quot;:false}" data-tags="[]" data-execution_count="1">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xarray <span class="im">as</span> xr</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> intake</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> s3fs</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cartopy.crs <span class="im">as</span> ccrs</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cartopy.feature <span class="im">as</span> cfeature</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cftime</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cftime <span class="im">import</span> DatetimeNoLeap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
</div>
</section>
<section id="climate-data-description" class="level2">
<h2 class="anchored" data-anchor-id="climate-data-description"><strong>(1) Climate Data Description</strong></h2>
<p>Using the CMIP6 database hosted on Amazon Web Services, we will be downloading/using both historical simulations and future projections from two climate models (<code>GFDL-ESM4</code> and <code>IPSL-CM6A-LR</code>) for <code>ssp370</code>.</p>
<p><strong>Climate Models:</strong> <br> <code>GFDL-ESM4</code> is the Geophysical Fluid Dynamics Laboratory (GFDL) Earth System Model version 4 (ESM4) climate model. It’s a coupled chemistry-carbon-climate Earth system model that was developed at the GFDL. As described by <a href="https://www.gfdl.noaa.gov/earth-system-esm4/">NOAA</a>, <code>GFDL-ESM4</code> consists of:</p>
<ul>
<li>atmosphere at approximately 1 degree resolution with 49 levels of comprehensive, interactive chemistry and aerosols (including aerosol indirect effect) from precursor emissions</li>
<li>OM4 MOM6-based ocean at ½ degree resolution with 75 levels using hybrid pressure/isopycnal vertical coordinate</li>
<li>SIS2 sea ice with radiative transfer and C-grid dynamics for compatibility with MOM6</li>
<li>LM4.1 land model with a new vegetation dynamics model with explicit treatment of plant age and height structure and soil microbes, with daily fire, crops, pasture, and grazing tiles</li>
<li>COBALTv2 ocean biogeochemical component representing ocean ecological and biogeochemical interactions</li>
<li>Fully Interactive dust and iron cycling between land-atmosphere and ocean</li>
</ul>
<p><code>IPSL-CM6A-LR</code> is the latest version of the Institut Pierre Simon Laplace (IPSL) climate model. It’s a physical atmosphere-land-ocean-sea ice model that also includes a representation of the carbon cycle, and it was developed at the IPSL to study natural climate variability and climate response to both anthropogenic and natural changes as part of CMIP6.</p>
<p><strong>SSP Scenario:</strong> <br> <code>ssp370</code> (also written as <code>SSP3-RCP7.0</code>) refers to the Shared Socioeconomic Pathway 3 combined with a radiative forcing level of 7.0 W/m² by the year 2100. It is considered a medium-to-high emissions scenario and commonly known as the “Regional Rivalry” pathway, characterized by high challenges to both mitigation and adaptation. A <a href="https://www.carbonbrief.org/explainer-how-shared-socioeconomic-pathways-explore-future-climate-change/">Carbon Brief</a> article written by Zeke Hausfather describes SSP3 as the following:</p>
<ul>
<li><em>“A resurgent nationalism, concerns about competitiveness and security, and regional conflicts push countries to increasingly focus on domestic or, at most, regional issues. Policies shift over time to become increasingly oriented toward national and regional security issues. Countries focus on achieving energy and food security goals within their own regions at the expense of broader-based development. Investments in education and technological development decline. Economic development is slow, consumption is material-intensive, and inequalities persist or worsen over time. Population growth is low in industrialized and high in developing countries. A low international priority for addressing environmental concerns leads to strong environmental degradation in some regions.”</em></li>
</ul>
</section>
<section id="climate-data-download-acquisition" class="level2">
<h2 class="anchored" data-anchor-id="climate-data-download-acquisition"><strong>(2) Climate Data Download &amp; Acquisition</strong></h2>
<p>We’ll be downloading surface air temperature (<code>tas</code>) data from the following two climate models:</p>
<ul>
<li><code>GFDL-ESM4</code></li>
<li><code>IPSL-CM6A-LR</code></li>
</ul>
<p>For each climate model, we need:</p>
<ul>
<li>Historical simulations</li>
<li>Future projections for <code>ssp370</code></li>
</ul>
<p><strong>Characteristics of these files</strong> (corresponding fields in the CMIP6 catalog are in parentheses):</p>
<ul>
<li><em>Variable (“variable_id”)</em>: This is a surface air temperature, or “tas”, variable.</li>
<li><em>Realm (“table_id”)</em>: Surface air temperature is generated by the atmosphere component of a climate model (“A”), and the information in this particular file is averaged monthly (“mon”).</li>
<li><em>Model (“source_id”)</em>: The name of the climate model</li>
<li><em>Experiment (“experiment_id”)</em>: The name of the model experiment being run. The file above is a <em>historical</em> simulation: since we’re also interested in the future projection information, we’ll further specify that we’d also like the associated SSP below.</li>
<li><em>Ensemble member (“member_id”)</em>: The name of this ensemble member is “r1i1p1f1”.</li>
</ul>
<p>The workflow used to download the data was guided by the <a href="https://github.com/climate-datalab/CMIP6_AWS">Accessing CMIP6 Data via AWS</a> tutorial.</p>
<div id="31b32faf-6f13-460d-a63a-8c7d395dda0e" class="cell" data-tags="[]" data-execution_count="2">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Open the CMIP6 data catalog, store as a variable</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>CMIP6_catalog <span class="op">=</span> intake.open_esm_datastore(<span class="st">'https://cmip6-pds.s3.amazonaws.com/pangeo-cmip6.json'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="climate-model-1-gfdl-esm4" class="level4">
<h4 class="anchored" data-anchor-id="climate-model-1-gfdl-esm4">Climate model #1: <strong>GFDL-ESM4</strong></h4>
<div id="d50ebaeb-a4ed-4de1-adb7-3693649a5d60" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify search terms to query catalog for GFDL-ESM4 data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># activity_id: which project do you want? CMIP = historical data, ScenarioMIP = future projections</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>activity_ids <span class="op">=</span> [<span class="st">'ScenarioMIP'</span>, <span class="st">'CMIP'</span>]</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># source_id: which model do you want? </span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>source_id <span class="op">=</span> [<span class="st">'GFDL-ESM4'</span>]</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># experiment_id: what experimental configuration do you want? Here we want historical and ssp370</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>experiment_ids <span class="op">=</span> [<span class="st">'historical'</span>, <span class="st">'ssp370'</span>]</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># member_id: which ensemble member do you want? Here we want r1i1p1f1</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>member_id <span class="op">=</span> <span class="st">'r1i1p1f1'</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># table_id: which part of the Earth system and time resolution do you want? Here we want monthly atmosphere data</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>table_id <span class="op">=</span> <span class="st">'Amon'</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co"># variable_id: which climate variable do you want? Here we want surface air temperature</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>variable_id <span class="op">=</span> <span class="st">'tas'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="93cdd24f-9d86-4bae-9678-a4203c665a1e" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Search through catalog, store results in "res" variable</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>res_gfdl <span class="op">=</span> CMIP6_catalog.search(activity_id<span class="op">=</span>activity_ids, source_id<span class="op">=</span>source_id, experiment_id<span class="op">=</span>experiment_ids, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                     member_id<span class="op">=</span>member_id, table_id<span class="op">=</span>table_id, variable_id<span class="op">=</span>variable_id)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Display data frame associated with results</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>display(res_gfdl.df)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract data for the historical period, store as a separate xarray Dataset</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>hist_data_gfdl <span class="op">=</span> xr.open_zarr(res_gfdl.df[<span class="st">'zstore'</span>][<span class="dv">1</span>], storage_options<span class="op">=</span>{<span class="st">'anon'</span>: <span class="va">True</span>})</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract data for each SSP </span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>future_data_ssp370_gfdl <span class="op">=</span> xr.open_zarr(res_gfdl.df[<span class="st">'zstore'</span>][<span class="dv">0</span>], storage_options<span class="op">=</span>{<span class="st">'anon'</span>: <span class="va">True</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">activity_id</th>
<th data-quarto-table-cell-role="th">institution_id</th>
<th data-quarto-table-cell-role="th">source_id</th>
<th data-quarto-table-cell-role="th">experiment_id</th>
<th data-quarto-table-cell-role="th">member_id</th>
<th data-quarto-table-cell-role="th">table_id</th>
<th data-quarto-table-cell-role="th">variable_id</th>
<th data-quarto-table-cell-role="th">grid_label</th>
<th data-quarto-table-cell-role="th">zstore</th>
<th data-quarto-table-cell-role="th">dcpp_init_year</th>
<th data-quarto-table-cell-role="th">version</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>ScenarioMIP</td>
<td>NOAA-GFDL</td>
<td>GFDL-ESM4</td>
<td>ssp370</td>
<td>r1i1p1f1</td>
<td>Amon</td>
<td>tas</td>
<td>gr1</td>
<td>s3://cmip6-pds/CMIP6/ScenarioMIP/NOAA-GFDL/GFD...</td>
<td>NaN</td>
<td>20180701</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>CMIP</td>
<td>NOAA-GFDL</td>
<td>GFDL-ESM4</td>
<td>historical</td>
<td>r1i1p1f1</td>
<td>Amon</td>
<td>tas</td>
<td>gr1</td>
<td>s3://cmip6-pds/CMIP6/CMIP/NOAA-GFDL/GFDL-ESM4/...</td>
<td>NaN</td>
<td>20190726</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="climate-model-2-ipsl-cm6a-lr" class="level4">
<h4 class="anchored" data-anchor-id="climate-model-2-ipsl-cm6a-lr">Climate model #2: <strong>IPSL-CM6A-LR</strong></h4>
<div id="7845007f-d812-4db2-9540-e2c591e91195" class="cell" data-tags="[]" data-execution_count="5">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify search terms to query catalog for IPSL-CM6A data</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># activity_id: which project do you want? CMIP = historical data, ScenarioMIP = future projections</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>activity_ids <span class="op">=</span> [<span class="st">'ScenarioMIP'</span>, <span class="st">'CMIP'</span>]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># source_id: which model do you want? </span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>source_id <span class="op">=</span> [<span class="st">'IPSL-CM6A-LR'</span>]</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># experiment_id: what experimental configuration do you want? Here we want historical and ssp370</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>experiment_ids <span class="op">=</span> [<span class="st">'historical'</span>, <span class="st">'ssp370'</span>]</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># member_id: which ensemble member do you want? Here we want r1i1p1f1</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>member_id <span class="op">=</span> <span class="st">'r1i1p1f1'</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co"># table_id: which part of the Earth system and time resolution do you want? Here we want monthly atmosphere data</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>table_id <span class="op">=</span> <span class="st">'Amon'</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co"># variable_id: which climate variable do you want? Here we want surface air temperature</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>variable_id <span class="op">=</span> <span class="st">'tas'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="68e66a6d-4f0b-47a7-86db-8055a4f73f30" class="cell" data-tags="[]" data-execution_count="6">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Search through catalog, store results in "res" variable</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>res_ipsl <span class="op">=</span> CMIP6_catalog.search(activity_id<span class="op">=</span>activity_ids, source_id<span class="op">=</span>source_id, experiment_id<span class="op">=</span>experiment_ids, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                     member_id<span class="op">=</span>member_id, table_id<span class="op">=</span>table_id, variable_id<span class="op">=</span>variable_id)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Display data frame associated with results</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>display(res_ipsl.df)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract data for the historical period, store as a separate xarray Dataset</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>hist_data_ipsl <span class="op">=</span> xr.open_zarr(res_ipsl.df[<span class="st">'zstore'</span>][<span class="dv">0</span>], storage_options<span class="op">=</span>{<span class="st">'anon'</span>: <span class="va">True</span>})</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract data for each SSP </span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>future_data_ssp370_ipsl <span class="op">=</span> xr.open_zarr(res_ipsl.df[<span class="st">'zstore'</span>][<span class="dv">1</span>], storage_options<span class="op">=</span>{<span class="st">'anon'</span>: <span class="va">True</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">activity_id</th>
<th data-quarto-table-cell-role="th">institution_id</th>
<th data-quarto-table-cell-role="th">source_id</th>
<th data-quarto-table-cell-role="th">experiment_id</th>
<th data-quarto-table-cell-role="th">member_id</th>
<th data-quarto-table-cell-role="th">table_id</th>
<th data-quarto-table-cell-role="th">variable_id</th>
<th data-quarto-table-cell-role="th">grid_label</th>
<th data-quarto-table-cell-role="th">zstore</th>
<th data-quarto-table-cell-role="th">dcpp_init_year</th>
<th data-quarto-table-cell-role="th">version</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>CMIP</td>
<td>IPSL</td>
<td>IPSL-CM6A-LR</td>
<td>historical</td>
<td>r1i1p1f1</td>
<td>Amon</td>
<td>tas</td>
<td>gr</td>
<td>s3://cmip6-pds/CMIP6/CMIP/IPSL/IPSL-CM6A-LR/hi...</td>
<td>NaN</td>
<td>20180803</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>ScenarioMIP</td>
<td>IPSL</td>
<td>IPSL-CM6A-LR</td>
<td>ssp370</td>
<td>r1i1p1f1</td>
<td>Amon</td>
<td>tas</td>
<td>gr</td>
<td>s3://cmip6-pds/CMIP6/ScenarioMIP/IPSL/IPSL-CM6...</td>
<td>NaN</td>
<td>20190119</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="focus-region-southern-africa" class="level2">
<h2 class="anchored" data-anchor-id="focus-region-southern-africa"><strong>(3) Focus Region – Southern Africa</strong></h2>
<p>The focus region for this analysis is Southern Africa. As it sounds, it’s the southernmost region of Africa. There are various definitions for the exact extent of this region, but we’ll be using the delineation of the <a href="https://en.wikipedia.org/wiki/United_Nations_geoscheme">United Nations geoscheme</a> that includes Botswana, Eswatini, Lesotho, Namibia, and South Africa.</p>
<p><strong>Southern Africa Climate:</strong> <br> Due to its size and varied geography, the greater Southern Africa region exhibits a wide range of climates. In general, this area is characterized by a subtropical to temperate climate, with significant variations in temperature and rainfall throughout the year. The northwest reaches of Southern Africa (namely western Namibia) exhibit desert conditions, the eastern coast can be classified as more subtropical, and the southwest (coastal reaches of South Africa) experience a Mediterranean climate. As mentioned above, average mean surface air temperature and precipitation vary significanly both throughout the region and annually. Southern areas throughout South Africa are cooler than the northern locations in Namibia and Botswana, with average mean surface air temperatures around 17 - 19 deg C and 22 - 24 deg C, respectively. Annually, temperatures fluctuate significantly with Nov - Mar being the hottest, and Apr - Oct the coldest. Southern areas of Southern Africa recieve less mean annual rainfall than northern areas of this region, and similarly to temperature trends, annual precipitation varies significantly with the vast majority of rainfall occuring in the wet season months (Nov - March), and little to no rainfall during the dry season (Apr - Oct).</p>
<p><strong>Climate Change Impacts:</strong> <br> In a region that already experiences drastic fluctuations in temperature and precipitation throughout each year, I might expect these patterns to become even more pronounced under a changing climate. I would expect overall rainfall to decrease, with an increase in extreme precipitation events like atmospheric rivers. This would likely result in more frequent drying of river and stream networks, with and more frequent flooding events. Following global trends, I would expect average temperatures to also increase throughout the greater Southern Africa Region.</p>
<p><strong>A reasonable lat/lon bounds for the Southern Africa Region is:</strong></p>
<ul>
<li>Latitude range of 38°S to 15°S</li>
<li>Longitude range of 10°E to 38°E</li>
</ul>
<p><em>Information on Southern Africa’s climate was sourced from the <a href="https://climateknowledgeportal.worldbank.org/">Climate Change Knowledge Portal</a>.</em></p>
</section>
<section id="focus-on-specific-time-periods-make-maps" class="level2">
<h2 class="anchored" data-anchor-id="focus-on-specific-time-periods-make-maps"><strong>(4) Focus on Specific Time Periods &amp; Make Maps</strong></h2>
<p>This analysis focuses on the following two time periods:</p>
<ul>
<li><strong>2000-2050</strong></li>
<li><strong>2050-2100</strong></li>
</ul>
<p>I chose these time periods to get a sense of climatic trends in a recent to mid century window, and mid to late century window to acquire a full picture of temperature trends in the Southern Africa region throughout this century.</p>
<section id="data-processing" class="level3">
<h3 class="anchored" data-anchor-id="data-processing"><strong>Data Processing</strong></h3>
<p>First, we’ll concatenate the historical and SSP information into a single <code>xarray</code> object to make the plotting simpler:</p>
<div id="1f5e4339-f0cf-40a6-bf04-f7997bf822b6" class="cell" data-tags="[]" data-execution_count="7">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># GFDL-ESM4 data</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>gfdl_data_ssp370 <span class="op">=</span> xr.concat([hist_data_gfdl, future_data_ssp370_gfdl], dim<span class="op">=</span><span class="st">"time"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># IPSL-CM6A-LR data </span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>ipsl_data_ssp370 <span class="op">=</span> xr.concat([hist_data_ipsl, future_data_ssp370_ipsl], dim<span class="op">=</span><span class="st">"time"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="84de7521-a778-40c6-b968-f8e4800a0bef" class="cell" data-jupyter="{&quot;outputs_hidden&quot;:true}" data-tags="[]" data-execution_count="8">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># examine the time format for both datasets </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#print(gfdl_data_ssp370.time)</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#print(ipsl_data_ssp370.time)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code></code></pre>
</div>
</div>
<p>It looks like the IPSL model data is already in a <code>dtype</code> of <code>datetime64</code>; however, we’ll need to change the format of the GFDL data to <code>datetime64</code> to make plotting easier with <code>Matplotlib</code></p>
<div id="1e8d5cbe-108e-4c02-a804-dedfbf6669e5" class="cell" data-jupyter="{&quot;outputs_hidden&quot;:true}" data-tags="[]" data-execution_count="9">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the time variable to datetime format in the GFDL data</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>time <span class="op">=</span> gfdl_data_ssp370.time.astype(<span class="st">'datetime64[ns]'</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#print(time)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code></code></pre>
</div>
</div>
<section id="define-the-time-periods-were-mapping" class="level4">
<h4 class="anchored" data-anchor-id="define-the-time-periods-were-mapping">Define the Time Periods We’re Mapping</h4>
<p>First, we need to examine the time formats of each climate model.</p>
<div id="818ee862-bbc4-4dd6-8a16-ab68eb866fc0" class="cell" data-tags="[]" data-execution_count="10">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(gfdl_data_ssp370.time.values[<span class="dv">0</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'cftime._cftime.DatetimeNoLeap'&gt;</code></pre>
</div>
</div>
<div id="2f2ea7fc-4d4f-484a-84a2-33c17177d496" class="cell" data-tags="[]" data-execution_count="11">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(ipsl_data_ssp370.time.values[<span class="dv">0</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'numpy.datetime64'&gt;</code></pre>
</div>
</div>
<p><code>gfdl_data_ssp370</code> uses <code>cftime.DatetimeNoLeap</code>, which requires using that same calendar class. So, we need to use a different start and end date format that’s compatible for selecting specific time periods out of this object. The <code>ipsl_data_ssp370</code> time coordinate uses standard <code>numpy.datetime64</code>, so we can slice it with normal strings like “2000-01-01” and don’t need <code>cftime</code>.</p>
<div id="6d4394cf-c9fe-4c56-8a34-abcd58c776c9" class="cell" data-tags="[]" data-execution_count="12">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract an xarray DataArray containing the tas variable</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>gfdl_data_ssp370 <span class="op">=</span> gfdl_data_ssp370.tas</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>ipsl_data_ssp370 <span class="op">=</span> ipsl_data_ssp370.tas</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># convert units from Kelvin to Celsius</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>gfdl_data_ssp370 <span class="op">=</span> gfdl_data_ssp370 <span class="op">-</span> <span class="fl">273.15</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>ipsl_data_ssp370 <span class="op">=</span> ipsl_data_ssp370 <span class="op">-</span> <span class="fl">273.15</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="select-the-time-periods-for-the-gfdl-data" class="level4">
<h4 class="anchored" data-anchor-id="select-the-time-periods-for-the-gfdl-data">Select the time periods for the <code>GFDL</code> data</h4>
<div id="fe574bcc-f3e2-4ca5-995c-260ba9bef279" class="cell" data-tags="[]" data-execution_count="13">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the first time period</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>start_date1 <span class="op">=</span> DatetimeNoLeap(<span class="dv">2000</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>end_date1 <span class="op">=</span> DatetimeNoLeap(<span class="dv">2050</span>, <span class="dv">12</span>, <span class="dv">31</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># define the second time period </span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>start_date2 <span class="op">=</span> DatetimeNoLeap(<span class="dv">2050</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>end_date2 <span class="op">=</span> DatetimeNoLeap(<span class="dv">2100</span>, <span class="dv">12</span>, <span class="dv">31</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co"># extract data for 2000-2050</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>temp_data_slice_gfdl_2000 <span class="op">=</span> gfdl_data_ssp370.sel(</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    time<span class="op">=</span>(gfdl_data_ssp370.time <span class="op">&gt;=</span> start_date1) <span class="op">&amp;</span> </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>         (gfdl_data_ssp370.time <span class="op">&lt;=</span> end_date1)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co"># extract data for 2050-2100</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>temp_data_slice_gfdl_2050 <span class="op">=</span> gfdl_data_ssp370.sel(</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    time<span class="op">=</span>(gfdl_data_ssp370.time <span class="op">&gt;=</span> start_date2) <span class="op">&amp;</span> </span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>         (gfdl_data_ssp370.time <span class="op">&lt;=</span> end_date2)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="select-the-time-periods-for-the-ipsl-data" class="level4">
<h4 class="anchored" data-anchor-id="select-the-time-periods-for-the-ipsl-data">Select the time periods for the <code>IPSL</code> data</h4>
<div id="4da63ecd-1ba9-48af-af83-6baa6866b9c6" class="cell" data-tags="[]" data-execution_count="14">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract data for 2000-2050</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>temp_data_slice_ipsl_2000 <span class="op">=</span> ipsl_data_ssp370.sel(</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    time<span class="op">=</span><span class="bu">slice</span>(<span class="st">"2000-01-01"</span>, <span class="st">"2050-12-31"</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># extract data for 2050-2100</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>temp_data_slice_ipsl_2050 <span class="op">=</span> ipsl_data_ssp370.sel(</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    time<span class="op">=</span><span class="bu">slice</span>(<span class="st">"2050-01-01"</span>, <span class="st">"2100-12-31"</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="map-the-mean-average-over-each-time-period" class="level3">
<h3 class="anchored" data-anchor-id="map-the-mean-average-over-each-time-period"><strong>Map the Mean Average Over Each Time Period</strong></h3>
<p>Take the time average of our filtered data for each climate model, and plot it for our specific region of interest (Southern Africa).</p>
<div id="697c125f-0f6e-473c-b123-c3b29c9f52c0" class="cell" data-tags="[]" data-execution_count="15">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Time average GFDL</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>temp_data_mn_gfdl_2000 <span class="op">=</span> temp_data_slice_gfdl_2000.mean(dim<span class="op">=</span>[<span class="st">"time"</span>])</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>temp_data_mn_gfdl_2050 <span class="op">=</span> temp_data_slice_gfdl_2050.mean(dim<span class="op">=</span>[<span class="st">"time"</span>])</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Time average IPSL</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>temp_data_mn_ipsl_2000 <span class="op">=</span> temp_data_slice_ipsl_2000.mean(dim<span class="op">=</span>[<span class="st">"time"</span>])</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>temp_data_mn_ipsl_2050 <span class="op">=</span> temp_data_slice_ipsl_2050.mean(dim<span class="op">=</span>[<span class="st">"time"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="gfdl-esm4" class="level4">
<h4 class="anchored" data-anchor-id="gfdl-esm4"><strong>2000-2050 &amp; 2050-2100</strong>, <code>GFDL-ESM4</code></h4>
<div id="b91024f2-0dea-4675-8df9-064a11f15f66" class="cell" data-tags="[]" data-execution_count="16">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define PlateCarree projection</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>map_proj <span class="op">=</span> ccrs.PlateCarree()</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create figure with two subplots side by side</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                         subplot_kw<span class="op">=</span>{<span class="st">"projection"</span>: map_proj})</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Shared settings</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>extent <span class="op">=</span> [<span class="dv">10</span>, <span class="dv">38</span>, <span class="op">-</span><span class="dv">38</span>, <span class="op">-</span><span class="dv">15</span>]</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for 2000-2050</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>plot1 <span class="op">=</span> axes[<span class="dv">0</span>].pcolormesh(</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    temp_data_mn_gfdl_2000.lon, temp_data_mn_gfdl_2000.lat,</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    temp_data_mn_gfdl_2000, transform<span class="op">=</span>map_proj, cmap<span class="op">=</span><span class="st">"coolwarm"</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">30</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_extent(extent, crs<span class="op">=</span>map_proj)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].add_feature(cfeature.COASTLINE)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].add_feature(cfeature.BORDERS, linestyle<span class="op">=</span><span class="st">":"</span>)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>gl1 <span class="op">=</span> axes[<span class="dv">0</span>].gridlines(draw_labels<span class="op">=</span><span class="va">True</span>, linestyle<span class="op">=</span><span class="st">"--"</span>)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>gl1.top_labels <span class="op">=</span> <span class="va">False</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>gl1.right_labels <span class="op">=</span> <span class="va">False</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">"Surface Air Temperature: 2000–2050"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Hide gridlines (make the lines transparent)</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>gl1.xlines <span class="op">=</span> <span class="va">False</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>gl1.ylines <span class="op">=</span> <span class="va">False</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for 2050-2100</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>plot2 <span class="op">=</span> axes[<span class="dv">1</span>].pcolormesh(</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>    temp_data_mn_gfdl_2050.lon, temp_data_mn_gfdl_2050.lat,</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>    temp_data_mn_gfdl_2050, transform<span class="op">=</span>map_proj, cmap<span class="op">=</span><span class="st">"coolwarm"</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">30</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_extent(extent, crs<span class="op">=</span>map_proj)</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].add_feature(cfeature.COASTLINE)</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].add_feature(cfeature.BORDERS, linestyle<span class="op">=</span><span class="st">":"</span>)</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>gl2 <span class="op">=</span> axes[<span class="dv">1</span>].gridlines(draw_labels<span class="op">=</span><span class="va">True</span>, linestyle<span class="op">=</span><span class="st">"--"</span>)</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>gl2.top_labels <span class="op">=</span> <span class="va">False</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>gl2.left_labels <span class="op">=</span> <span class="va">False</span></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">"Surface Air Temperature: 2050–2100"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Hide gridlines (make the lines transparent)</span></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>gl2.xlines <span class="op">=</span> <span class="va">False</span></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>gl2.ylines <span class="op">=</span> <span class="va">False</span></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Add shared colorbar</span></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>cbar <span class="op">=</span> fig.colorbar(plot2, ax<span class="op">=</span>axes[:], orientation<span class="op">=</span><span class="st">'horizontal'</span>, fraction<span class="op">=</span><span class="fl">0.05</span>, pad<span class="op">=</span><span class="fl">0.07</span>)</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>cbar.set_label(<span class="st">"Temperature (°C)"</span>)</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Add main title</span></span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">"Projected Surface Air Temperature for Southern Africa (GFDL-ESM4)"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-17-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ipsl-cm6a-lr" class="level4">
<h4 class="anchored" data-anchor-id="ipsl-cm6a-lr"><strong>2000-2050 &amp; 2050-2100</strong>, <code>IPSL-CM6A-LR</code></h4>
<div id="a9e7534e-54cf-493b-9282-8b83d5222957" class="cell" data-tags="[]" data-execution_count="17">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define PlateCarree projection</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>map_proj <span class="op">=</span> ccrs.PlateCarree()</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create figure with two subplots side by side</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>),</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>                         subplot_kw<span class="op">=</span>{<span class="st">"projection"</span>: map_proj})</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Shared settings</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>extent <span class="op">=</span> [<span class="dv">10</span>, <span class="dv">38</span>, <span class="op">-</span><span class="dv">38</span>, <span class="op">-</span><span class="dv">15</span>]</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for 2000-2050</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>plot1 <span class="op">=</span> axes[<span class="dv">0</span>].pcolormesh(</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    temp_data_mn_ipsl_2000.lon, temp_data_mn_ipsl_2000.lat,</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    temp_data_mn_ipsl_2000, transform<span class="op">=</span>map_proj, cmap<span class="op">=</span><span class="st">"coolwarm"</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">30</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_extent(extent, crs<span class="op">=</span>map_proj)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].add_feature(cfeature.COASTLINE)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].add_feature(cfeature.BORDERS, linestyle<span class="op">=</span><span class="st">":"</span>)</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>gl1 <span class="op">=</span> axes[<span class="dv">0</span>].gridlines(draw_labels<span class="op">=</span><span class="va">True</span>, linestyle<span class="op">=</span><span class="st">"--"</span>)</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>gl1.top_labels <span class="op">=</span> <span class="va">False</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>gl1.right_labels <span class="op">=</span> <span class="va">False</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">"Surface Air Temperature: 2000–2050"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Hide gridlines (make the lines transparent)</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>gl1.xlines <span class="op">=</span> <span class="va">False</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>gl1.ylines <span class="op">=</span> <span class="va">False</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for 2050-2100</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>plot2 <span class="op">=</span> axes[<span class="dv">1</span>].pcolormesh(</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>    temp_data_mn_ipsl_2050.lon, temp_data_mn_ipsl_2050.lat,</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>    temp_data_mn_ipsl_2050, transform<span class="op">=</span>map_proj, cmap<span class="op">=</span><span class="st">"coolwarm"</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">30</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_extent(extent, crs<span class="op">=</span>map_proj)</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].add_feature(cfeature.COASTLINE)</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].add_feature(cfeature.BORDERS, linestyle<span class="op">=</span><span class="st">":"</span>)</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>gl2 <span class="op">=</span> axes[<span class="dv">1</span>].gridlines(draw_labels<span class="op">=</span><span class="va">True</span>, linestyle<span class="op">=</span><span class="st">"--"</span>)</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>gl2.top_labels <span class="op">=</span> <span class="va">False</span></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>gl2.left_labels <span class="op">=</span> <span class="va">False</span></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">"Surface Air Temperature: 2050–2100"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Hide gridlines (make the lines transparent)</span></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>gl2.xlines <span class="op">=</span> <span class="va">False</span></span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>gl2.ylines <span class="op">=</span> <span class="va">False</span></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Add shared colorbar</span></span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>cbar <span class="op">=</span> fig.colorbar(plot2, ax<span class="op">=</span>axes[:], orientation<span class="op">=</span><span class="st">'horizontal'</span>, fraction<span class="op">=</span><span class="fl">0.05</span>, pad<span class="op">=</span><span class="fl">0.07</span>)</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>cbar.set_label(<span class="st">"Temperature (°C)"</span>)</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Add main title</span></span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">"Projected Surface Air Temperature for Southern Africa (IPSL-CM6A-LR)"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-18-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="map-the-difference-in-the-averages-between-the-two-time-periods" class="level3">
<h3 class="anchored" data-anchor-id="map-the-difference-in-the-averages-between-the-two-time-periods"><strong>Map the Difference in the Averages Between the Two Time Periods</strong></h3>
<p>Take the difference between each time period.</p>
<div id="987c36b4-294a-422b-b294-9bfbbae5e0a1" class="cell" data-tags="[]" data-execution_count="18">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subtract the mid century tas data from the late century tas data</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>gfdl_tas_diff <span class="op">=</span> temp_data_mn_gfdl_2050 <span class="op">-</span> temp_data_mn_gfdl_2000 </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>ipsl_tas_diff <span class="op">=</span> temp_data_mn_ipsl_2050 <span class="op">-</span> temp_data_mn_ipsl_2000 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="0fcb4017-d915-4a44-a41d-5854fe6595e3" class="cell" data-tags="[]" data-execution_count="19">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define PlateCarree projection</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>map_proj <span class="op">=</span> ccrs.PlateCarree()</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a figure with two subplots side by side</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>), </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                         subplot_kw<span class="op">=</span>{<span class="st">'projection'</span>: map_proj})</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Set common extent for both subplots (Southern Africa)</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>extent <span class="op">=</span> [<span class="dv">10</span>, <span class="dv">38</span>, <span class="op">-</span><span class="dv">38</span>, <span class="op">-</span><span class="dv">15</span>]</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Plot 1: GFDL-ESM4 ---</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>p1 <span class="op">=</span> axes[<span class="dv">0</span>].pcolormesh(</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    gfdl_tas_diff.lon, gfdl_tas_diff.lat, gfdl_tas_diff,</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    transform<span class="op">=</span>map_proj, cmap<span class="op">=</span><span class="st">"coolwarm"</span>, vmin<span class="op">=-</span><span class="fl">0.5</span>, vmax<span class="op">=</span><span class="fl">3.5</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_extent(extent, crs<span class="op">=</span>map_proj)</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].add_feature(cfeature.COASTLINE)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].add_feature(cfeature.BORDERS, linestyle<span class="op">=</span><span class="st">":"</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>gl1 <span class="op">=</span> axes[<span class="dv">0</span>].gridlines(draw_labels<span class="op">=</span><span class="va">True</span>, linestyle<span class="op">=</span><span class="st">"--"</span>)</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>gl1.top_labels <span class="op">=</span> <span class="va">False</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>gl1.right_labels <span class="op">=</span> <span class="va">False</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>gl1.xlines <span class="op">=</span> <span class="va">False</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>gl1.ylines <span class="op">=</span> <span class="va">False</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">"GFDL-ESM4: Δ Temp [(2050–2100) - (2000–2050)]"</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Plot 2: IPSL-CM6A-LR ---</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>p2 <span class="op">=</span> axes[<span class="dv">1</span>].pcolormesh(</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>    ipsl_tas_diff.lon, ipsl_tas_diff.lat, ipsl_tas_diff,</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>    transform<span class="op">=</span>map_proj, cmap<span class="op">=</span><span class="st">"coolwarm"</span>, vmin<span class="op">=-</span><span class="fl">0.5</span>, vmax<span class="op">=</span><span class="fl">3.5</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_extent(extent, crs<span class="op">=</span>map_proj)</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].add_feature(cfeature.COASTLINE)</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].add_feature(cfeature.BORDERS, linestyle<span class="op">=</span><span class="st">":"</span>)</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>gl2 <span class="op">=</span> axes[<span class="dv">1</span>].gridlines(draw_labels<span class="op">=</span><span class="va">True</span>, linestyle<span class="op">=</span><span class="st">"--"</span>)</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>gl2.top_labels <span class="op">=</span> <span class="va">False</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>gl2.left_labels <span class="op">=</span> <span class="va">False</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>gl2.xlines <span class="op">=</span> <span class="va">False</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>gl2.ylines <span class="op">=</span> <span class="va">False</span></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">"IPSL-CM6A-LR: Δ Temp [(2050–2100) - (2000–2050)]"</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Add shared colorbar below the plots</span></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>cbar <span class="op">=</span> fig.colorbar(p2, ax<span class="op">=</span>axes[:], orientation<span class="op">=</span><span class="st">'horizontal'</span>, fraction<span class="op">=</span><span class="fl">0.05</span>, pad<span class="op">=</span><span class="fl">0.07</span>)</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>cbar.set_label(<span class="st">"Temperature Change (°C)"</span>)</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Add main title</span></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">"Projected Change in Surface Air Temperature: Southern Africa"</span>, fontsize<span class="op">=</span><span class="dv">18</span>)</span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a caption</span></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>fig.text(<span class="fl">0.5</span>, <span class="fl">0.02</span>, </span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Temperature difference is taken by subracting the 50 year average between 2000-2050 from 50 year average between 2050-2100. Therefore, positive values represent an increase in average surface air temperatures."</span>, </span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>         ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-20-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="reflection" class="level2">
<h2 class="anchored" data-anchor-id="reflection"><strong>(5) Reflection</strong></h2>
<p><strong>Results:</strong> <br> Looking at the first sets of plots that show the projected average surface air temperature in Southern Africa between time periods of 2000-2050 and 2050-2100, it’s evident that temperatures are projected to increase moving into the late century. This trend becomes more apparent when taking the difference between the average temperatures of each time period. We subtracted the earlier period from the later period; therefore, positive values represent an increase in projected average temperatures, and negative values represent a decrease. Looking at our difference plots above for each climate model, there’s a clear trend of increasing projected air temperatures. It’s interesting to note that the <code>IPSL-CM6A-LR</code> climate model projects a more significant increase than the <code>GFDL-ESM4</code> model.</p>
<p><strong>Implications:</strong> <br> Rising average surface air temperatures across the greater Southern Africa region are likely to have widespread and compounding effects on both human populations and ecosystems. Higher temperatures can lead to increased evaporation rates and soil moisture loss, further stressing agricultural systems already vulnerable to climate variability. Crop failures may become more frequent, and livestock health may deteriorate as heat stress intensifies. Ecosystems throughout the region will also face mounting pressure, with species being forced to adapt, migrate, or face possible decline as thermal thresholds are exceeded. For human populations, prolonged exposure to extreme heat may worsen health outcomes, particularly for those with limited access to cooling infrastructure or healthcare. In urban areas, the intensification of the urban heat island effect could exacerbate social inequalities, while in rural areas, higher temperatures may further strain already limited water and food resources.</p>
</section>
<section id="acknowledgements" class="level2">
<h2 class="anchored" data-anchor-id="acknowledgements"><strong>(6) Acknowledgements</strong></h2>
<p>This assignment was created and organized Sam Stevenson-Karl, an Associate Professor at the Bren School and the instructor for EDS 296-1S. EDS 296-1S (Advanced Special Topics in Environmental Data Science: A Climate Modeling Perspective on Big Data Techniques) is offered in the <a href="https://bren.ucsb.edu/masters-programs/master-environmental-data-science">Master of Environmental Data Science (MEDS)</a> program at the Bren School.</p>
<p>The workflow used to complete this analysis was adopted from the <a href="https://github.com/climate-datalab">Climate DataLab</a>, an open source resource for climate model education that’s supported by a growing community of educators, scientists, and developers working together to make climate data science more inclusive and effective.</p>


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{pepperdine2025,
  author = {Pepperdine, Maxwell},
  title = {From Clouds to Code: Mapping Big Climate Data with {Python}},
  date = {2025-05-11},
  url = {https://maxpepperdine.github.io/posts/2025-05-11-mapping-big-climate-data/},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-pepperdine2025" class="csl-entry quarto-appendix-citeas" role="listitem">
Pepperdine, Maxwell. 2025. <span>“From Clouds to Code: Mapping Big
Climate Data with Python.”</span> May 11, 2025. <a href="https://maxpepperdine.github.io/posts/2025-05-11-mapping-big-climate-data/">https://maxpepperdine.github.io/posts/2025-05-11-mapping-big-climate-data/</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2024, Maxwell Pepperdine</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This website is built with <i class="fa-brands fa-github" title="the octocat guthub icon" aria-label="github"></i></p>
</div>
  </div>
</footer>




</body></html>